# GUI –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π –ü–ª–∞–Ω

## üéØ –¶–µ–ª—å

–°–æ–∑–¥–∞—Ç—å low-level GUI –±–∏–±–ª–∏–æ—Ç–µ–∫—É –Ω–∞ Rust —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ HTML-–ø–æ–¥–æ–±–Ω—ã—Ö —à–∞–±–ª–æ–Ω–æ–≤.

## üìê –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
brul-gui/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ core/           # –ë–∞–∑–æ–≤—ã–µ –ø—Ä–∏–º–∏—Ç–∏–≤—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ geometry.rs # –¢–æ—á–∫–∏, —Ä–∞–∑–º–µ—Ä—ã, –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ color.rs    # –¶–≤–µ—Ç–∞ –∏ –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ style.rs    # –°—Ç–∏–ª–∏ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ render/         # –°–∏—Å—Ç–µ–º–∞ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ renderer.rs # –û—Å–Ω–æ–≤–Ω–æ–π —Ä–µ–Ω–¥–µ—Ä–µ—Ä (wgpu)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ batch.rs    # –ü–∞–∫–µ—Ç–Ω–∞—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∞
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ shader.rs   # –®–µ–π–¥–µ—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ widgets/        # –í–∏–¥–∂–µ—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ mod.rs
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ container.rs
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ text.rs
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ rectangle.rs
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ button.rs
‚îÇ   ‚îú‚îÄ‚îÄ layout/         # –°–∏—Å—Ç–µ–º–∞ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ mod.rs
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ flex.rs     # Flexbox layout
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ stack.rs    # Stack layout
‚îÇ   ‚îú‚îÄ‚îÄ events/         # –°–∏—Å—Ç–µ–º–∞ —Å–æ–±—ã—Ç–∏–π
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ mod.rs
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ mouse.rs
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ keyboard.rs
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ event.rs
‚îÇ   ‚îú‚îÄ‚îÄ app/            # –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ event loop
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ mod.rs
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ app.rs
‚îÇ   ‚îú‚îÄ‚îÄ lib.rs          # –ì–ª–∞–≤–Ω—ã–π –º–æ–¥—É–ª—å
‚îÇ   ‚îî‚îÄ‚îÄ main.rs         # –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
‚îú‚îÄ‚îÄ Cargo.toml
‚îî‚îÄ‚îÄ README.md
```

## üé® –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏

### 1. –ë–∞–∑–æ–≤—ã–µ –ø—Ä–∏–º–∏—Ç–∏–≤—ã (Core)

**Point** - 2D —Ç–æ—á–∫–∞ —Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏ (x, y)

```rust
pub struct Point { x: f32, y: f32 }
```

**Size** - —Ä–∞–∑–º–µ—Ä (width, height)

```rust
pub struct Size { width: f32, height: f32 }
```

**Rect** - –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫ (–ø–æ–∑–∏—Ü–∏—è + —Ä–∞–∑–º–µ—Ä)

```rust
pub struct Rect { x: f32, y: f32, width: f32, height: f32 }
```

**Edges** - –æ—Ç—Å—Ç—É–ø—ã (margin/padding)

```rust
pub struct Edges { left, right, top, bottom: f32 }
```

**Color** - —Ü–≤–µ—Ç —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π RGBA

```rust
pub struct Color { r: f32, g: f32, b: f32, a: f32 }
```

### 2. –°–∏—Å—Ç–µ–º–∞ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞

**Renderer** - –æ–±–µ—Ä—Ç–∫–∞ –Ω–∞–¥ wgpu –¥–ª—è:

- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±—É—Ñ–µ—Ä–∞–º–∏ –∏ —Ç–µ–∫—Å—Ç—É—Ä–∞–º–∏
- –ü–∞–∫–µ—Ç–Ω–æ–π –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ –ø—Ä–∏–º–∏—Ç–∏–≤–æ–≤
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏—è —à–µ–π–¥–µ—Ä–∞–º–∏

**Batch** - –ø–∞–∫–µ—Ç –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –ø—Ä–∏–º–∏—Ç–∏–≤–æ–≤:

- –¢–µ–∫—Å—Ç—É—Ä—ã
- –ì–µ–æ–º–µ—Ç—Ä–∏—è
- –°—Ç–∏–ª–∏

### 3. –í–∏–¥–∂–µ—Ç—ã (Widgets)

–ë–∞–∑–æ–≤—ã–π —Ç—Ä–µ–π—Ç `Widget`:

```rust
pub trait Widget {
    fn layout(&mut self, constraints: BoxConstraints) -> Size;
    fn paint(&self, renderer: &mut Renderer, bounds: Rect);
    fn handle_event(&mut self, event: &Event) -> bool;
}
```

**Container** - –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å –æ—Ç—Å—Ç—É–ø–∞–º–∏ –∏ —Ñ–æ–Ω–æ–º
**Text** - —Ç–µ–∫—Å—Ç–æ–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç —Å —à—Ä–∏—Ñ—Ç–æ–º
**Rectangle** - –ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–π –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫
**Button** - –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–Ω–æ–ø–∫–∞

### 4. –°–∏—Å—Ç–µ–º–∞ layout

**BoxConstraints** - –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–ª—è layout:

```rust
pub struct BoxConstraints {
    min_width: f32,
    max_width: f32,
    min_height: f32,
    max_height: f32,
}
```

**Flex Layout** - flexbox-–ø–æ–¥–æ–±–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞
**Stack Layout** - –Ω–∞–ª–æ–∂–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥—Ä—É–≥ –Ω–∞ –¥—Ä—É–≥–∞

### 5. –°–∏—Å—Ç–µ–º–∞ —Å–æ–±—ã—Ç–∏–π

**Event** - –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏–π:

- MouseMove, MouseDown, MouseUp
- KeyDown, KeyUp
- Resize, Close

**EventResult** - —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏:

- StopPropagation
- Continue
- RequestRedraw

## üîÑ –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```
1. –°–æ–∑–¥–∞–Ω–∏–µ App
   ‚Üì
2. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Renderer
   ‚Üì
3. –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ Widget Tree
   ‚Üì
4. Layout Phase (—Ä–∞—Å—á–µ—Ç —Ä–∞–∑–º–µ—Ä–æ–≤)
   ‚Üì
5. Paint Phase (–æ—Ç—Ä–∏—Å–æ–≤–∫–∞)
   ‚Üì
6. Event Loop (–æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π)
   ‚Üì
7. Repeat (4-6)
```

## üìù API Design

### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:

```rust
use brul_gui::prelude::*;

fn main() {
    let app = App::new();

    let root = Container::new()
        .padding(Edges::new(10.0))
        .background(Color::rgb(0.9, 0.9, 0.9))
        .child(
            Flex::column()
                .child(Text::new("Hello, World!"))
                .child(
                    Button::new("Click me")
                        .on_click(|_| println!("Clicked!"))
                )
        );

    app.run(root);
}
```

## üöÄ –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ —ç—Ç–∞–ø–∞–º

### –≠—Ç–∞–ø 1: –ë–∞–∑–æ–≤—ã–µ –ø—Ä–∏–º–∏—Ç–∏–≤—ã

- [ ] Geometry (Point, Size, Rect, Edges)
- [ ] Color
- [ ] Style

### –≠—Ç–∞–ø 2: –†–µ–Ω–¥–µ—Ä–∏–Ω–≥

- [ ] Renderer –Ω–∞ wgpu
- [ ] –ë–∞–∑–æ–≤—ã–µ –ø—Ä–∏–º–∏—Ç–∏–≤—ã (–ª–∏–Ω–∏–∏, –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–∏)
- [ ] –¢–µ–∫—Å—Ç (—á–µ—Ä–µ–∑ fontdue –∏–ª–∏ similar)

### –≠—Ç–∞–ø 3: –í–∏–¥–∂–µ—Ç—ã

- [ ] Widget trait
- [ ] Container
- [ ] Rectangle
- [ ] Text

### –≠—Ç–∞–ø 4: Layout

- [ ] BoxConstraints
- [ ] Flex layout
- [ ] Stack layout

### –≠—Ç–∞–ø 5: –°–æ–±—ã—Ç–∏—è

- [ ] Event system
- [ ] Mouse handling
- [ ] Keyboard handling

### –≠—Ç–∞–ø 6: App & Integration

- [ ] App struct
- [ ] Event loop integration
- [ ] –ü—Ä–∏–º–µ—Ä—ã

## üìö –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

**–û—Å–Ω–æ–≤–Ω—ã–µ:**

- `winit` - –æ–∫–Ω–∞ –∏ —Å–æ–±—ã—Ç–∏—è (—É–∂–µ –µ—Å—Ç—å)
- `wgpu` - —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ (—É–∂–µ –µ—Å—Ç—å)
- `tokio` - async (—É–∂–µ –µ—Å—Ç—å)

**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ:**

- `fontdue` - —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ —à—Ä–∏—Ñ—Ç–æ–≤
- `glam` - –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞ (–≤–µ–∫—Ç–æ—Ä—ã, –º–∞—Ç—Ä–∏—Ü—ã)
- `bytemuck` - —Ä–∞–±–æ—Ç–∞ —Å –±–∞–π—Ç–∞–º–∏

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å core –ø—Ä–∏–º–∏—Ç–∏–≤—ã
3. –°–æ–∑–¥–∞—Ç—å –±–∞–∑–æ–≤—ã–π —Ä–µ–Ω–¥–µ—Ä–µ—Ä
4. –î–æ–±–∞–≤–∏—Ç—å –≤–∏–¥–∂–µ—Ç—ã
5. –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å event loop
